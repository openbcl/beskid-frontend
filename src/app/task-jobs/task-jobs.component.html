<p-panel class="be-panel-jobs be-panel-no-padding" header="Task Jobs In Queue">
  @if(jobs$ | async; as jobs) {
    @if(breakpoint$ | async; as breakpoint) {
      <p-table *beRecreateViewKey="breakpoint" responsiveLayout="stack"
      [breakpoint]="breakpoint" styleClass="p-datatable-striped" [columns]="columns"
      [value]="jobs" sortMode="multiple" [scrollable]="true" scrollHeight="452px" >
        <ng-template pTemplate="header" let-columns>
            <tr>
              <th [style]="'width: ' + columns[0].width" pSortableColumn="model.name">
                {{ columns[0].header }}
                <p-sortIcon field="model.name" />
              </th>
              <th [style]="'width: ' + columns[1].width" pSortableColumn="model.resolutions[0]">
                {{ columns[1].header }}
                <p-sortIcon field="model.resolutions[0]" />
              </th>
              <th [style]="'width: ' + columns[2].width" pSortableColumn="state">
                {{ columns[2].header }}
                <p-sortIcon field="state" />
              </th>
            </tr>
        </ng-template>
        <ng-template pTemplate="body" let-rowData let-columns="columns">
          <tr [pSelectableRow]="rowData">
            <td><span class="p-column-title font-semibold">{{ columns[0].header }}</span>{{ rowData.model.name }}</td>
            <td><span class="p-column-title font-semibold">{{ columns[1].header }}</span>{{ rowData.model.resolutions[0] }}</td>
            <td><span class="p-column-title font-semibold">{{ columns[2].header }}</span>
               @switch (rowData.state) {
                 @case ('waiting') {
                   <div class="relative w-8rem">
                     <span class="absolute z-1 w-full text-center p-1">{{ rowData.state }}</span>   
                     <p-progressBar class="relative" mode="indeterminate" [style]="{ height: '1.75em' }" />
                    </div>
                  }
                  @case ('active') {
                    <div class="flex flex-wrap gap-3 align-items-center">
                      <span>{{ rowData.state }}</span>   
                      <p-progressSpinner strokeWidth="6"  styleClass="w-2rem h-2rem"></p-progressSpinner>
                    </div>
                  }
                  @default () {
                    <span>{{ rowData.state }}</span>   
                  }
               }
            </td>
          </tr>
        </ng-template>
        <ng-template pTemplate="emptymessage">
          <tr>
            <td colspan="3" class="text-center">No jobs are currently running.</td>
          </tr>
        </ng-template>
      </p-table>
    }
  }
</p-panel>